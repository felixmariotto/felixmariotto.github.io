!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.immersify=t():e.immersify=t()}(self,(function(){return(()=>{"use strict";var e={};(e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})})(e);const t={requestSession:function(){return new Promise((e=>{navigator.xr.requestSession("immersive-vr",{optionalFeatures:["local-floor","bounded-floor","hand-tracking","layers"]}).then((t=>{this.session=t,e()}))}))}};const n=document.createElement("button");n.innerHTML="Enter VR",n.id="immersify-vrbutton",n.style.position="fixed",n.style.left="50%",n.style.bottom="20px",n.style.width="120px",n.style.height="50px",n.style.borderRadius="25px",n.style.borderColor="#333333",n.style.borderStyle="solid",n.style.color="#333333",n.style.transform="translateX( -50% )",n.style.fontFamily="Calibri",n.style.fontSize="1.4em",n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="center",n.style.cursor="pointer";const o=function(){const e=document.createElement("canvas");e.width=28,e.height=28;const t=e.getContext("2d");return t.imageSmoothingQuality="high",t.beginPath(),t.arc(14,14,12,2*Math.PI*.7-Math.PI/2,-Math.PI/2,!0),t.lineWidth=2,t.strokeStyle="#333333",t.stroke(),e}();let i;function s(e){return new Promise(((t,n)=>{const o=document.createElement("script");o.src=e,o.addEventListener("load",t),o.addEventListener("error",(e=>n(e.error))),document.head.appendChild(o)}))}n.addEventListener("click",(async()=>{n.innerHTML="",n.append(o),i=setInterval((()=>{o.style.transform=`rotate( ${Date.now()%1e3/1e3*360}deg )`}),17),s("https://cdn.jsdelivr.net/npm/three@0.131.0/build/three.js").then((()=>{!function(){class e extends THREE.Mesh{constructor(e){const n=new t(e),o=new THREE.PlaneGeometry(.001*n.image.width,.001*n.image.height),i=new THREE.MeshBasicMaterial({map:n,toneMapped:!1});function s(e){i.map.dispatchEvent(e)}super(o,i),this.addEventListener("mousedown",s),this.addEventListener("mousemove",s),this.addEventListener("mouseup",s),this.addEventListener("click",s)}}class t extends THREE.CanvasTexture{constructor(e){super(o(e)),this.dom=e,this.anisotropy=16,this.encoding=THREE.sRGBEncoding,this.minFilter=THREE.LinearFilter,this.magFilter=THREE.LinearFilter}dispatchEvent(e){!function(e,t,n,o){const i={clientX:n*e.offsetWidth+e.offsetLeft,clientY:o*e.offsetHeight+e.offsetTop,view:e.ownerDocument.defaultView};window.dispatchEvent(new MouseEvent(t,i));const s=e.getBoundingClientRect();n=n*s.width+s.left,o=o*s.height+s.top,function e(s){if(3!==s.nodeType){const a=s.getBoundingClientRect();n>a.left&&n<a.right&&o>a.top&&o<a.bottom&&s.dispatchEvent(new MouseEvent(t,i));for(var r=0;r<s.childNodes.length;r++)e(s.childNodes[r])}}(e)}(this.dom,e.type,e.data.x,e.data.y),this.update()}update(){this.image=o(this.dom),this.needsUpdate=!0}}const n=new WeakMap;function o(e){var t=document.createRange();function o(e,t,n,o){""!==o&&("uppercase"===e.textTransform&&(o=o.toUpperCase()),a.font=e.fontSize+" "+e.fontFamily,a.textBaseline="top",a.fillStyle=e.color,a.fillText(o,t,n))}function i(e,t,n,o,i,s){var r=e[t+"Width"],d=e[t+"Style"],l=e[t+"Color"];"0px"!==r&&"none"!==d&&"transparent"!==l&&"rgba(0, 0, 0, 0)"!==l&&(a.strokeStyle=l,a.beginPath(),a.moveTo(n,o),a.lineTo(n+i,o+s),a.stroke())}const s=e.getBoundingClientRect();let r;n.has(e)?r=n.get(e):(r=document.createElement("canvas"),r.width=s.width,r.height=s.height);const a=r.getContext("2d"),d=new function(e){var t=[],n=!1;function o(){if(n&&(n=!1,e.restore()),0!==t.length){for(var o=-1/0,i=-1/0,s=1/0,r=1/0,a=0;a<t.length;a++){var d=t[a];o=Math.max(o,d.x),i=Math.max(i,d.y),s=Math.min(s,d.x+d.width),r=Math.min(r,d.y+d.height)}e.save(),e.beginPath(),e.rect(o,i,s-o,r-i),e.clip(),n=!0}}return{add:function(e){t.push(e),o()},remove:function(){t.pop(),o()}}}(a);return function e(n,r){var l=0,c=0,h=0,p=0;if(3===n.nodeType)t.selectNode(n),l=(u=t.getBoundingClientRect()).left-s.left-.5,c=u.top-s.top-.5,h=u.width,p=u.height,o(r,l,c,n.nodeValue.trim());else{if(!n.style||"none"===n.style.display)return;var u;l=(u=n.getBoundingClientRect()).left-s.left-.5,c=u.top-s.top-.5,h=u.width,p=u.height;var f=(r=window.getComputedStyle(n)).backgroundColor;"transparent"!==f&&"rgba(0, 0, 0, 0)"!==f&&(a.fillStyle=f,a.fillRect(l,c,h,p)),i(r,"borderTop",l,c,h,0),i(r,"borderLeft",l,c,0,p),i(r,"borderBottom",l,c+p,h,0),i(r,"borderRight",l+h,c,0,p),"color"!==n.type&&"text"!==n.type||(d.add({x:l,y:c,width:h,height:p}),o(r,l+parseInt(r.paddingLeft),c+parseInt(r.paddingTop),n.value),d.remove())}var m="auto"===r.overflow||"hidden"===r.overflow;m&&d.add({x:l,y:c,width:h,height:p});for(var y=0;y<n.childNodes.length;y++)e(n.childNodes[y],r);m&&d.remove()}(e),r}THREE.HTMLMesh=e}();const e=[s("https://cdn.jsdelivr.net/npm/three@0.131.0/examples/js/geometries/BoxLineGeometry.js"),s("https://cdn.jsdelivr.net/npm/three@0.131.0/examples/js/controls/OrbitControls.js")];n.skipXR||e.push(t.requestSession()),Promise.all(e).then((()=>{!function(e,n){const o=window.innerWidth,i=window.innerHeight,s=document.createElement("canvas");s.style.width="100vw",s.style.height="100vh",s.style.position="fixed",s.style.left="0",s.style.top="0",s.style.zIndex="10000";const r=new THREE.Scene;r.background=new THREE.Color(5263440);const a=new THREE.PerspectiveCamera(60,o/i,.1,100),d=new THREE.WebGLRenderer({antialias:!0,canvas:s});d.setPixelRatio(window.devicePixelRatio),d.setSize(o,i),d.xr.enabled=!0,document.body.appendChild(s);const l=new THREE.OrbitControls(a,s);a.position.set(0,1.6,0),l.target=new THREE.Vector3(0,1,-1.8),l.update(),n&&async function(){await d.xr.setSession(t.session)}();const c=new THREE.LineSegments(new THREE.BoxLineGeometry(6,6,6,10,10,10).translate(0,3,0),new THREE.LineBasicMaterial({color:8421504})),h=new THREE.HTMLMesh(e);h.position.set(0,1,-2),h.rotation.x=-.2,r.add(c,h),d.setAnimationLoop((function(){d.render(r,a)})),window.addEventListener("resize",(function(){a.aspect=window.innerWidth/window.innerHeight,a.updateProjectionMatrix(),d.setSize(window.innerWidth,window.innerHeight)}))}(document.body,!n.skipXR)})).catch((e=>{console.error(e)}))})).catch((e=>{console.error(e)}))}));const r=n;return window?window.addEventListener("load",(()=>{r.skipXR=!0,document.body.append(r)})):console.warn("immersify can't find window object."),e})()}));